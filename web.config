<?xml version="1.0" encoding="utf-8"?>
<configuration>
	<system.webServer>
		<!-- Remove WebDAV module to allow PUT and DELETE requests -->
		<modules runAllManagedModulesForAllRequests="true">
			<remove name="WebDAVModule" />
		</modules>
		
		<!-- Remove WebDAV handler -->
		<handlers>
			<remove name="WebDAV" />
			<remove name="ExtensionlessUrlHandler-Integrated-4.0" />
			<add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
		</handlers>
		
		<!-- Add CORS and security headers -->
		<!-- Note: Using wildcard (*) for CORS as this is a frontend SPA that calls external APIs -->
		<!-- For production, consider restricting to specific domains -->
		<httpProtocol>
			<customHeaders>
				<add name="Access-Control-Allow-Origin" value="*" />
				<add name="Access-Control-Allow-Methods" value="GET, POST, PUT, DELETE, PATCH, OPTIONS" />
				<add name="Access-Control-Allow-Headers" value="Content-Type, Authorization, X-Requested-With" />
				<add name="Access-Control-Max-Age" value="3600" />
			</customHeaders>
		</httpProtocol>
		
		<rewrite>
			<rules>
				<rule name="SPA fallback" stopProcessing="true">
					<match url=".*" />
					<conditions logicalGrouping="MatchAll">
						<add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
						<add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
					</conditions>
					<action type="Rewrite" url="/index.html" />
				</rule>
			</rules>
		</rewrite>
		
		<!-- Configure static content -->
		<staticContent>
			<!-- Remove existing MIME types first to prevent conflicts -->
			<remove fileExtension=".json" />
			<remove fileExtension=".woff" />
			<remove fileExtension=".woff2" />
			<mimeMap fileExtension=".json" mimeType="application/json" />
			<mimeMap fileExtension=".woff" mimeType="application/font-woff" />
			<mimeMap fileExtension=".woff2" mimeType="application/font-woff2" />
		</staticContent>
	</system.webServer>
</configuration>
